
<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="google-site-verification" content="eaMIZ8VDf3iqRxt6tz92X2_IBHCVPi1yNeat5o06rBA" />
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Please Input Your Correct Information.">
    <title>Money Plant Link Pvt. Ltd. FLM Call & Traveling Bill Management System</title>
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            background: linear-gradient(to right, #074fa7, #fad0c4);
            color: #333;
            text-align: center;
        }
        header {
            margin-top: 20px;
        }
        header img {
            width: 150px;
            height: auto;
            margin-right: 20px;
        }
        h1 {
            color: #12f77a;
            margin-top: 20px;
        }
        form {
            background: #ffffff;
            border-radius: 10px;
            padding: 2em;
            margin: 15px auto;
            max-width: 600px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        label {
            display: block;
            margin: 10px 0 5px;
            color: #03ca21;
            font-size: 18px;
        }
        input[type="text"], input[type="date"], textarea, select {
            width: calc(100% - 20px);
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #ddd;
            margin-bottom: 10px;
        }
        button {
            background-color: #ff6f61;
            border: none;
            color: white;
            padding: 10px 15px;
            text-align: center;
            font-size: 2em;
            margin: 10px 0;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover {
            background-color: #ff3b30;
        }
        footer {
            background: #333;
            padding: 8px;
            color: #fff;
            width: 100%;
            text-align: center;
        }
        #thankYouMessage {
            display: none;
            margin-top: 20px;
            color: #ff0000;
            font-size: 3.2em;
            position: relative;
        }
        .button-container {
            margin: 20px;
            text-align: center;
        }
        .button-container button {
            background-color: #007bff;
            border: none;
            color: white;
            padding: 10px 20px;
            font-size: 1em;
            cursor: pointer;
            margin-left: 10px;
        }
        .button-container button:hover {
            background-color: #0056b3;
        }
        /* Modal styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }
        .modal-content {
            background-color: #fff;
            margin: 15% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
            max-width: 400px;
        }
        .modal-content button {
            margin-top: 10px;
        }
        /* Error message styling */
        .error-message {
            color: red;
            font-size: 1em;
            margin-top: 5px;
        }
        .success-message {
            color: green;
            font-size: 1em;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <header>
        <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRXbepMX_Wr3Ls3sZu7UgeVzUqh6SucsH5_kg&s" alt="Money Plant Logo">
    </header>
    <h1>FLM Call & Traveling Bill Management System</h1>
    <form id="myForm" method="post" action="https://script.google.com/macros/s/AKfycby8G8qwhM3s0D4Ws0eTs1AHpSgDWVYy3BG5W5mB_aVC2UiU1ZJGhkp0AigssIDUBlpc-w/exec" onsubmit="handleSubmit(event)">
        <label for="Date">Date:</label>
        <input type="date" id="Date" name="Date" required>                            

        <label for="EmployeeID">Employee ID:</label>
        <input type="text" id="JobID" name="JobID" placeholder="Enter Employee ID" required oninput="updateExecutiveNameAndZone()">
        <div id="EmployeeIDError" class="error-message"></div>

        <label for="ExecutiveName">Executive Name:</label>
        <input type="text" id="ExecutiveName" name="ExecutiveName" placeholder="Auto-filled based on Employee ID" required readonly>

        <label for="Zone">Zone:</label>
        <input type="text" id="Zone" name="Zone" placeholder="Auto-filled based on Employee ID" required readonly>

        <label for="ATMCRMID">ATM/CRM ID:</label>
        <input type="text" id="ATMCRMID" name="ATMCRMID" placeholder="Enter ATM or CRM ID" required oninput="updateATMLocation()">
        <div id="ATMCRMIDError" class="error-message"></div>

        <label for="ATMLOCATION">ATM Location:</label>
        <input type="text" id="ATMLOCATION" name="ATMLOCATION" placeholder="Auto-filled based on ATM or CRM ID" required>

        <label for="TypeOfCall">Type Of Call:</label>
        <select id="TypeOfCall" name="TypeOfCall" required>
            <option value="">Select an option</option>
            <option value="Cash Jam">Cash Jam</option>
            <option value="Receive Paper">Receive Paper</option>
            <option value="Down">Down</option>
            <option value="Engineer Call">Engineer Call</option>
            <option value="PM">PM</option>
            <option value="Fast Load">Fast Load</option>
            <option value="Last Load">Last Load</option>
            <option value="Return">Return</option>
            <option value="Manual Cash Jam">Manual Cash Jam</option>
            <option value="ADC Call">ADC Call</option>
            <option value="Other’s">Other’s</option>
        </select>

        <label for="InTime">ATM/CRM Open Time:</label>
        <input type="time" id="InTime" name="InTime" required>

        <label for="OutTime">ATM/CRM Close Time:</label>
        <input type="time" id="OutTime" name="OutTime" required>

        <label for="From">From:</label>
        <input type="text" id="From" name="From" placeholder="Enter your bill start location" required>

        <label for="To">To:</label>
        <input type="text" id="To" name="To" placeholder="Enter your bill End location" required>

        <label for="Transport">Transport:</label>
        <input type="text" id="Transport" name="Transport" placeholder="Enter What transport are you using?" required>

        <label for="TravellingAmount">Travelling Amount:</label>
        <input type="text" id="TravellingAmount" name="TravellingAmount" placeholder="Enter Travelling Amount" required>

        <label for="Person">How many people's bills?:</label>
        <select id="Person" name="Person" required>
            <option value="">Select an option</option>
            <option value="1 Person">1 Person</option>
            <option value="2 Person">2 Person</option>
        </select>

        <label for="Remarks">Remarks:</label>
        <textarea id="Remarks" name="Remarks" placeholder="Enter any remarks here" required></textarea>

        <button type="submit">Submit</button>
        <div id="formError" class="error-message"></div>
        <div id="formSuccess" class="success-message"></div>
    </form>

    <div id="thankYouMessage">Thank you for your valuable time</div>

    <div class="button-container">
        <button onclick="window.open('https://docs.google.com/spreadsheets/d/1FstppDGmBMCmVG5K-owyqD6wl7DKYfFwfCjOC26d-Ag/pubhtml?gid=0&single=true', '_blank')">Show Your Call</button>
        <button onclick="window.open('https://docs.google.com/spreadsheets/d/1Zl8JI8J4TPR3ZOFy3kz-aYIpOOBuQBY8n1hBZ1apm4Y/edit?gid=1995041031#gid=1995041031', '_blank')">Ta Bill Show</button>
        <button onclick="showShortageOptions()">Show Your Shortage</button>
    </div>

    <!-- Modal for Shortage options -->
    <div id="shortageModal" class="modal">
        <div class="modal-content">
            <p>Select your zone:</p>
            <button onclick="promptPassword('Dhaka-1')">Dhaka-1</button>
            <button onclick="promptPassword('Dhaka-2')">Dhaka-2</button>
            <button onclick="closeModal()">Close</button>
        </div>
    </div>

    <footer>
        <p>Version 2.0 - Powered by Rahimul Islam. If you need any information please contact 01976755754,
        Money Plant Link Pvt. Ltd. © 2024</p>
    </footer>

    <!-- জাভাস্ক্রিপ্ট কোড এখানে রাখুন -->
    <script>
        // Map of Job IDs to Executive Names
        const jobIdToName = {
            1024: 'Md. Rokon Uddin', 
            1046: 'Md. Rahimul Islam', 
            1007: 'Md. Syedur Rahman', 
            1017: 'Abdullah-Al-Mamun',
            1270: 'Palash Roy', 
            1021: 'Md. Rocky Mia', 
            1025: 'Md. Miraj Hossain', 
            1026: 'Md. Kamruzzaman', 
            1165: 'Khalid Hossain Shaikh', 
            1152: 'Md. Ariful Islam', 
            1448: 'Md. Alamgir Kabir', 
            1587: 'Abdul Quddus (Jewel)', 
            1789: 'Md. Jahangir Alam', 
            1945: 'Md. Mofijul Islam', 
            1243: 'Md. Al Amin', 
            1659: 'Md. Shajahan Ali', 
            11127: 'Md. Zakir Hossin', 
            11285: 'Md. Emrul Islam', 
            11358: 'Md. Masruful Islam', 
            11279: 'Abu Shahin', 
            11656: 'Md. Arif Hossain-3', 
            11733: 'Md. Zasim Uddin', 
            11594: 'Bikash Roy', 
            11660: 'Md. Anowarul Islam', 
            11747: 'Md. Rakib Ali', 
            11707: 'SK Ramez Ahmed Rana', 
            11731: 'Md. Arif Hossain-4', 
            11999: 'Hasan Mia', 
            11810: 'Md. Kaysar Ahmed', 
            11815: 'Md. Rabbiul Hasan', 
            12113: 'Md. Miraj Mia-2', 
            12059: 'Md. Nazmul Hassan', 
            12065: 'Shayama Pada Sana', 
            11968: 'Mehedi Hasan Sagor', 
            12071: 'Abdus Salam', 
            12060: 'Atiqur Rahman', 
            12038: 'Md. Sofiqul Islam Bashar', 
            1596: 'Plock Kumer Raha', 
            12057: 'Md. Solaiman Khan', 
            11374: 'MD. RAKIB UDDIN', 
            11245: 'YASIR ARAFAT', 
            1950: 'Meraz Mahmud', 
            11336: 'Md. Asaduzzaman Roni', 
            11843: 'Mynul Islam', 
            1465: 'MD. EMRAN', 
            11719: 'SHUVANKAR BAIRAGI', 
            11790: 'AKTARUL BIN HASAN', 
            11751: 'MD. AL AMIN SARDAR', 
            11364: 'MD. ABU RAYHAN', 
            11655: 'Anwar Hossain', 
            12089: 'Subroto Kuri', 
            11247: 'Md.Jahangir Fokir', 
            12181: 'Md. Rahedul Islam', 
            12183: 'Md. Tanvir Hasan', 
            12182: 'Mirajul Islam', 
            11888: 'MD. AMIR HOSSAIN', 
            12220: 'Kawser Ahmed Fahim',  
            2024012232: 'Mehedi Hasan', 
            2024012223: 'Abdul Barik', 
            11816: 'Mosharof Hossain', 
            2024012225: 'Abdur Rahman', 
            2024012231: 'Abdullah Al Sakib', 
            2024012266: 'Md. Rasel', 
            202408012315: 'Sawpan Das', 
            1018: 'Sukanta Bepari', 
            1033: 'Raju Ahmed-1', 
            1283: 'Md. Piearul Islam', 
            1890: 'Md. Serajul Islam', 
            1976: 'Md. Raju Biswas',  
            1240: 'Md. Sazal', 
            11271: 'Md. Mahmudul Hasan', 
            11272: 'Md. Atikur Rahman', 
            11274: 'Md. Ariful Islam-2', 
            11282: 'Md. Saddam Hossain', 
            11283: 'Md. Shahinur Islam', 
            11475: 'Md. Sohanur Rahman', 
            11485: 'Md. Rajuan Islam', 
            11487: 'Md. Tanvir Hussain Emon', 
            11489: 'Md. Sohan Ali', 
            11609: 'Md. Towhid Hossain', 
            11625: 'Md. Ratul', 
            11680: 'Abu Saleh', 
            11740: 'Md. Golam Gaus', 
            11927: 'Mojibur Rahman', 
            12117: 'Md. Nurnobi Hossen', 
            11958: 'Shafiqul Islam', 
            11276: 'Binoy Halder', 
            12009: 'Md. Samsur Rahman', 
            12010: 'Md. Nayon Babu', 
            12142: 'Md. Asadullah Al Masud', 
            12145: 'Md. Azizul Hakim', 
            12146: 'Md. Rafi Hossain Shipon', 
            11783: 'Omor Sharif Khalifa', 
            1043: 'Nasir Uddin',
            12066: 'Md.Mohibullah  ',
            11765: 'Md. Suzon'
            // Add other Job IDs here
        };

        // Map of Job IDs to Zones
        const jobIdToZone = {
             1024: 'Head Office', 
             1046: 'Head Office', 
             1007: 'Head Office', 
             1017: 'Abdullah-Al-Mamun', 
             1270: 'ADC', 
             1021: 'DEPZ', 
             1025: 'Konabari-2', 
             1026: 'Others Bank', 
             1165: 'Ashulia-2', 
             1152: 'Md. Ariful Islam', 
             1448: 'Head Office', 
             1587: 'Head Office', 
             1789: 'Head Office', 
             1945: 'Chandra-1', 
             1243: 'Savar-1', 
             1659: 'Others Bank', 
             11127: 'Md. Zakir Hossin', 
             11285: 'Savar-2', 
             11358: 'ADC', 
             11279: 'Nabinagar', 
             11656: 'Md. Arif Hossain-3', 
             11733: 'Md. Zasim Uddin', 
             11594: 'Savar-2', 
             11660: 'Chandra-2', 
             11747: 'Ashulia-1', 
             11707: 'Ashulia-1', 
             11731: 'Md. Arif Hossain-4', 
             11999: 'Hasan Mia', 
             11810: 'Konabari-1', 
             11815: 'Konabari-2', 
             12113: 'Md. Miraj Mia-2', 
             12059: 'Md. Nazmul Hassan', 
             12065: 'Chandra-2', 
             11968: 'Manikgonj-2', 
             12071: 'Chandra-1', 
             12060: 'Nabinagar', 
             12038: 'Konabari-1', 
             1596: 'Plock Kumer Raha', 
             12057: 'Md. Solaiman Khan', 
             11374: 'MD. RAKIB UDDIN', 
             11245: 'YASIR ARAFAT', 
             1950: 'Meraz Mahmud', 
             11843: 'Head Office', 
             1465: 'MD. EMRAN', 
             11719: 'SCB',
             12066: 'SCB',
             11790: 'SCB', 
             11751: 'Others Bank', 
             11364: 'MD. ABU RAYHAN', 
             11655: 'SCB', 
             12089: 'SCB', 
             11247: 'SCB', 
             12181: 'Savar-1', 
             12183: 'Md. Tanvir Hasan', 
             12182: 'Mirajul Islam', 
             11888: 'Card Carrying ', 
             12220: 'Kawser Ahmed Fahim', 
             12208: 'Md. Nazmul Islam', 
             2024012232: 'Manikgonj-1', 
             2024012223: 'Manikgonj-1', 
             11816: 'DEPZ', 
             2024012225: 'Ashulia-2', 
             2024012231: 'Abdullah Al Sakib', 
             2024012266: 'Manikgonj-2', 
             202408012315: 'Chandra-2', 
             1018: 'Sukanta Bepari', 
             1033: 'Head Office', 
             1283: 'College Gate', 
             1890: 'Bagher Bazar', 
             1976: 'Mawna',  
             1240: 'Uttara-2', 
             11271: 'Kaligonj', 
             11272: 'Tongi', 
             11274: 'Bagher Bazar', 
             11282: 'Mawna', 
             11283: 'Chowrasta-1', 
             11475: 'RPL', 
             11485: 'Uttara-1', 
             11487: 'Tongi', 
             11489: 'Uttara-1', 
             11609: 'Salna', 
             11625: 'College Gate', 
             11680: 'Master Bari', 
             11740: 'Salna', 
             11927: 'Chowrasta-2', 
             12117: 'Master Bari', 
             11958: 'Uttara-3', 
             11276: 'Chowrasta-1', 
             12009: 'Kaligonj', 
             12010: 'Uttara-3', 
             12142: 'Uttara-3', 
             12145: 'Uttara-2', 
             12146: 'RPL', 
             11783: 'CPC-2', 
             1043: 'Chowrasta-2',
             11765: 'CPC-2'
            // Add other Job IDs and their corresponding zones here
        };

        // Map of ATM/CRM IDs to ATM Locations
        const atmIdToLocation = {
'SCB3203': 'ICDDRB',
'SCB3300': 'Dhanmondi 5',
'SCB3303': 'Dhanmondi 5',
'SCB3305': 'Dhanmondi 5',
'SCB3308': 'Dhanmondi 5',
'SCB3311': 'Dhanmondi SC',
'SCB3312': 'Dhanmondi SC',
'SCB3402': 'Kawranbazar Br. CRM',
'SCB4406': 'Six Season',
'SCB4407': 'GP HOUSE',
'SCB4409': 'British High Commission',
'SCB4410': 'MBD',
'SCB4411': 'Banglalink',
'SCB4412': 'Bashundhara Branch',
'SCB4413': 'Robi',
'SCB4414': 'GP HOUSE',
'SCB4415': 'PRAN RFL',
'SCB4417': 'Apollo',
'SCB4418': 'Unilever',
'SCB4419': 'Square',
'SCB4423': 'United Hospital',
'SCB4426': 'North Gulshan',
'SCB6002': 'BAT',
'SCB6003': 'AISD',
'SCB6007': 'Bashundhara Branch',
'SCB6011': 'Adamjee ATM',
'SCB6604': 'Banani Branch',
'SCB6606': 'Banani Branch',
'SCB7501': 'Kakrail Branch',
'SCB7505': 'Kakrail Branch',
'SCB7600': 'North Gulshan',
'SCB7601': 'North Gulshan',
'SCB7701': 'Mirpur SC',
'SCB7702': 'World Bank',
'SCB7703': 'Uttara Branch',
'SCB7704': 'Mirpur SC',
'SCB7706': 'BCB',
'SCB7709': 'Uttara Branch',
'SCB7710': 'Lotus Kamal',
'SCB7712': 'Uttara Sector-1',
'SCB7713': 'Uttara Sector-1',
'SCB7714': 'Uttara Branch',
'SCB7715': 'Mirpur SC',
'SCB7716': 'UNDP ATM',
'SCB3900': 'Nasirabad-1',
'SCB3901': 'Nasirabad-2',
'SCB3904': 'Nasirabad-3',
'SCB6200': 'CEPZ',
'ASIA3': 'Conventional J U Joy Bangla CRM',
'ASIA172': 'Agent Baluchara Point',
'ASIA182': 'Agent Kaderabad Housing ATM',
'ASIA199': 'Agant Sagufta Agent NCR ATM',
'ASIA203': 'Conventional Millennium Tex ATM Unit-2',
'ASIA204': 'Conventional Millennium Tex ATM Unit-1',
'ASIA264': 'Conventional J U Bish Mile ATM',
'ASIA307': 'Agent Parish Road ATM',
'ASIA325': 'Conventional Kazipara offsite ATM',
'ASIA326': 'Conventional Jahir Smart Tower',
'IBBL9001': 'IBTRA Dhaka ATM',
'IBBL9002': 'Shyamoli Darus Salam Tower',
'IBBL9003': 'Shyamoli, Kallyanpur',
'IBBL9004': 'Rupnagar Mour',
'IBBL9005': 'Pallabi Sec-11',
'IBBL9006': 'Cantonment Matikata',
'IBBL9007': 'Cantonment Ibrahimpur',
'IBBL9008': 'Mohammadpur Town Hall',
'IBBL9009': 'Mohammadpur Br new',
'IBBL9010': 'MKM, Monsurabad',
'IBBL9011': 'Farmgate Green Road',
'IBBL9012': 'Farmgate Baitus Sharf Mosque',
'IBBL9013': 'Farmgate Sezan Point-Old',
'IBBL9014': 'Farmgate Sezan Point 2nd',
'IBBL9015': 'Farmgate Monipuri Para',
'IBBL9016': 'Farmgate Bijoy Sarani',
'IBBL9017': 'Nakhalpara Lucas Mour',
'IBBL9019': 'Mohakhali Wireless Gate',
'IBBL9020': 'Cantonment Manikdi',
'IBBL9021': 'Mirpur-1 Natun Bazar',
'IBBL9022': 'Amin Bazar Mazar Rd',
'IBBL9023': 'Amin Bazar Vakurta School',
'IBBL9024': 'Banani Fulu Tower-1',
'IBBL9025': 'Banani Fulu Tower-2',
'IBBL9026': 'Cantonment Purbo Sewrapara-1',
'IBBL9027': 'Cantonment Purbo Sewrapara-2',
'IBBL9028': 'Cantonment Purbo Kafrul',
'IBBL9029': 'Cantonment Sec-13',
'IBBL9030': 'Cantonment Vasantek WR',
'IBBL9031': 'Dhanmondi Asad Avinue',
'IBBL9032': 'Dhanmondi 5th Jhigatola',
'IBBL9041': 'Kawranbazar',
'IBBL9042': 'Kawranbazar BTMC Bhaban',
'IBBL9043': 'Kawranbazar Green Road AHPF Tower',
'IBBL9044': 'Mohakhali Kacha Bazar',
'IBBL9045': 'Mohakhali School Road',
'IBBL9046': 'Mohakhali Shahinbag',
'IBBL9047': 'Mirpur-1 Gudaraghat',
'IBBL9048': 'Mirpur-1 Mazar Road',
'IBBL9049': 'Mirpur-1 Chiriakhana Road-1',
'IBBL9050': 'Mirpur-1 Chiriakhana Road-2',
'IBBL9051': 'Mirpur-1 Hakim Plaza-1',
'IBBL9052': 'Mirpur-1 Hakim Plaza-2',
'IBBL9053': 'Mirpur-1 Ferdous Mosjid',
'IBBL9054': 'Mirpur-1 Tolarbagh',
'IBBL9057': 'Mirpur-1 Solimuddin Market',
'IBBL9058': 'Mirpur-1 Darussalam Thana',
'IBBL9059': 'Mirpur-1 Asian School',
'IBBL9060': 'Pallabi Rupnagar Sheba Ghar',
'IBBL9061': 'Pallabi Kalshi Road',
'IBBL9062': 'Pallabi Block-B Sec-11',
'IBBL9063': 'Kawranbazar Bashundhara City',
'IBBL9064': 'Mirpur Br. Sec-13-1',
'IBBL9065': 'Mirpur Br. Sec-13-2',
'IBBL9066': 'Mirpur Br. Kazipara-1',
'IBBL9067': 'Mirpur Br. Kazipara-2',
'IBBL9068': 'Mirpur Monipur School-1',
'IBBL9069': 'Mirpur Monipur School-2',
'IBBL9070': 'Mirpur Sec-2 NH School-1',
'IBBL9071': 'Mirpur Sec-2 NH School-2',
'IBBL9072': 'Mirpur Sec-6 Proshika-1',
'IBBL9073': 'Mirpur Sec-6 Proshika WR-2',
'IBBL9076': 'Dhanmondi Katashur(0729)',
'IBBL9018': 'Amin Bazar Nagar Kona',
'IBBL9033': 'Hemayetpur Tatuljhora',
'IBBL9034': 'Hemayetpur Rajfulbaria',
'IBBL9035': 'Hemayetpur Kornapara',
'IBBL9036': 'Kalampur Bus station',
'IBBL9037': 'Kalampur-3rd ATM',
'IBBL9038': 'Kalampur Kawli Para',
'IBBL9039': 'Kalampur Showapur',
'IBBL9040': 'Kalampur Joypura',
'IBBL9055': 'Mirpur-1, Kaundia Bazar',
'IBBL9056': 'Mirpur-2, Kaundia Bazar',
'IBBL9074': 'Hemayetpur Din Islam Tower(1752)',
'IBBL9075': 'Hemayetpur Bus Stand(0380)',
'IBBL9077': 'Manikgonj Kolia Bazar(1410)',
'IBBL9078': 'Manikgonj Doragram(1529)',
'IBBL9079': 'Manikgonj Gopalpur Bazar(1239)',
'IBBL9080': 'Manikgonj Teroshree(1282)',
'IBBL9081': 'Manikgonj Horgoj Bazar(1240)',
'IBBL9082': 'Manikgonj Pakotia Bazar(1241)',
'IBBL9083': 'Manikgonj Bangladesh Hat(1140)',
'IBBL9084': 'Manikgonj Lemu Bari(1141)',
'IBBL9085': 'Manikgonj Vatara Bazar(1411)',
'IBBL9086': 'Manikgonj Bharaia Bazar(1146)',
'IBBL9087': 'Manikgonj Lesrajong Bazar(1142)',
'IBBL9088': 'Manikgonj Gosta Bazar(1144)',
'IBBL9089': 'Manikgonj Savar Bazar(1280)',
'IBBL9090': 'Manikgonj Saturia Bazar(1409)',
'IBBL9091': 'Manikgonj Chachi Tara Bazar(1530)',
'IBBL9092': 'Manikgonj Gheor(1281)',
'IBBL9093': 'Savar Bank Tawn(1302)',
'IBBL9094': 'Savar Bus Stand Samad Tower(0601)',
'IBBL9095': 'Savar Garua Bazar(1451)',
'IBBL9096': 'Savar Sena Shoping Complex CAB(1467)',
'IBBL9097': 'Savar Upzila Complex(0923)',
'IBBL9098': 'Savar Siraj Shoping Complex(1077)',
'IBBL9099': 'Savar Pallibidyut(0860)',
'IBBL9100': 'Savar Dhogor Mora(1301)',
'IBBL9101': 'Savar CRP Road(1618)',
'IBBL9102': 'Savar New Market(1300)',
'IBBL9103': 'Savar Dakshin Bazar(0859)',
'IBBL9104': 'Savar Bus Stand Monsur Market(0453)',
'IBBL9105': 'Savar Akrain Bazar(1303)',
'IBBL9106': 'Savar Nur Mansion-1(1076)',
'IBBL9107': 'Savar Nur Mansion-2(0097)',
'IBBL9108': 'Savar Nama Bazar(1963)',
'IBBL9109': 'Savar Uttar Rajashon(1464)',
'IBBL9110': 'Singair Basta Bus Stand(1020)',
'IBBL9111': 'Singair Baira Bazar(1246)',
'IBBL9112': 'Singair South Jamsa Bazar(1247)',
'IBBL9113': 'Singair Shahrail Bazar(2080)',
'IBBL9114': 'Ziranibazar Madhobpur(1852)',
'IBBL9115': 'Ziranibazar Kabirpur Bazar(1418)',
'IBBL9116': 'Zirani Bazar Rahim Afrooz(0516)',
'IBBL9117': 'Ziranibazar Nabi Textile(1419)',
'IBBL9118': 'Zirani Bazar Mannan College(0106)',
'IBBL9119': 'Ziranibazar Auko Tex-1(0642)',
'IBBL9120': 'Ziranibazar Auko Tex-2(0873)',
'IBBL9121': 'Kalampur Kusura Bazar(2112)',
'IBBL9122': 'Shibaloy Rupsa Bazar(1584)',
'IBBL9123': 'Zirani Bazar BKSP(2133)',
'IBBL91203': 'Zirani Bazar BKSP(2133)','CBBL6': 'APBN Uttara',
'CBBL7': 'APBN Uttara',
'CBBL103': 'APBN Uttara',
'CBBL8': 'SPBN Mohammadpur',
'CBBL37': 'Gazipur Police Line ATM-1',
'CBBL38': 'Gazipur Police Line ATM-2',
'CBBL57': 'Faridpur Police Line ATM-1',
'CBBL58': 'Faridpur Police Line ATM-2',
'CBBL67': 'Rajbari Police Line ATM-1',
'CBBL68': 'Sirajgonj Police Line ATM-1',
'CBBL153': 'Sirajgonj Police Line ATM-2',
'CBBL16': 'POM, DMP, Mirpur',
'CBBL17': 'POM, DMP, Mirpur',
'CBBL29': 'POM, DMP, Mirpur',
'CBBL30': 'POM, DMP, Mirpur',
'CBBL31': 'POM, DMP, Mirpur',
'CBBL80': 'Bogura Police Line',
'CBBL81': 'Bogura Police Line-2',
'CBBL131': 'Bogra(APBN)',
'CBBL87': 'Gobindagonj police line',
'CBBL106': 'Pabna Police Line-1',
'CBBL107': 'Pabna Police Line-2',
'CBBL119': 'Manikgonj Police Line',
'CBBL108': 'Mymensingh Muktagasa(APBN)',
'CBBL109': 'Mymensingh Police Line',
'CBBL110': 'Mymensingh Police Line',
'CBBL136': 'Cox's Bazar Police Line-01',
'CBBL137': 'Cox's Bazar Police Line-02',
'CBBL169': 'Tecnaf Thana Cox's BZR',
'CBBL170': 'Ukhiya Thana ATM-1',
'CBBL190': 'Bandarban, Police Lines',
'CBBL134': 'Kustia Police Line',
'CBBL135': 'Kustia Police Line',
'CBBL104': 'Shaheed Police Smrity College -1',
'CBBL105': 'Shaheed Police Smrity College -2',
'CBBL95': 'Madaripur Police Line',
'CBBL78': 'Shariatpur Model Thana',
'CBBL151': 'GMP HQ Gazipur ATM-1',
'CBBL178': 'Industial Police, Ashulia','IBBL93': 'Zirani Bazar BKSP(2133)',
            // Add more ATM/CRM ID to Location mappings as needed
        };

        // Automatically set the current date
        window.onload = function() {
            const today = new Date();
            const bangladeshTimeOffset = 6 * 60 * 60 * 1000;  // বাংলাদেশ UTC+6
            const localDate = new Date(today.getTime() + bangladeshTimeOffset);
            const formattedDate = localDate.toISOString().split('T')[0];
            document.getElementById("Date").value = formattedDate;
        };

        // ফাংশন Employee ID এর ভিত্তিতে Executive Name এবং Zone আপডেট করার জন্য
        function updateExecutiveNameAndZone() {
            const jobId = document.getElementById('JobID').value.trim();
            const executiveName = jobIdToName[jobId] || '';
            const zone = jobIdToZone[jobId] || '';

            if (executiveName === '' || zone === '') {
                document.getElementById('EmployeeIDError').textContent = "Invalid Employee ID entered.";
            } else {
                document.getElementById('EmployeeIDError').textContent = "";
            }

            document.getElementById('ExecutiveName').value = executiveName;
            document.getElementById('Zone').value = zone;
        }

        // ফাংশন ATM/CRM ID এর ভিত্তিতে ATM Location আপডেট করার জন্য
        function updateATMLocation() {
            const atmId = document.getElementById('ATMCRMID').value.trim();
            const atmLocation = atmIdToLocation[atmId] || '';
            document.getElementById('ATMLOCATION').value = atmLocation;

            if (atmLocation === '') {
                document.getElementById('ATMCRMIDError').textContent = "Invalid ATM/CRM ID entered.";
            } else {
                document.getElementById('ATMCRMIDError').textContent = "";
            }
        }

        // ফর্ম সাবমিশন হ্যান্ডল করার ফাংশন
        function handleSubmit(event) {
            event.preventDefault();

            // ফর্মের কোনো এ্যারর আছে কি না চেক করা
            const employeeError = document.getElementById('EmployeeIDError').textContent;
            const atmError = document.getElementById('ATMCRMIDError').textContent;

            if (employeeError !== "" || atmError !== "") {
                document.getElementById('formError').textContent = "Please fix the errors above before submitting.";
                return;
            } else {
                document.getElementById('formError').textContent = "";
            }

            const inTime = document.getElementById('InTime').value;
            const outTime = document.getElementById('OutTime').value;
            const remarksField = document.getElementById('Remarks');
            const personField = document.getElementById('Person').value;

            // Remarks এ ইন টাইম এবং আউট টাইম যোগ করা
            remarksField.value += `\nIn Time: ${inTime}, Out Time: ${outTime}`;

            // নির্বাচিত সংখ্যার ভিত্তিতে বিল তথ্য যোগ করা
            if (personField === '1 Person') {
                remarksField.value += `\nBill for 1 Person`;
            } else if (personField === '2 Person') {
                remarksField.value += `\nBill for 2 Persons`;
            }

            // জিওলোকেশন গ্রহণের চেষ্টা করা
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function(position) {
                    const latitude = position.coords.latitude;
                    const longitude = position.coords.longitude;
                    const locationString = `Lat: ${latitude}, Long: ${longitude}`;
                    remarksField.value += `\nLocation: ${locationString}`;
                    submitForm(event);
                }, function(error) {
                    console.error("Error getting location: ", error);
                    document.getElementById('formError').textContent = "Unable to retrieve location.";
                    submitForm(event);
                });
            } else {
                console.error("Geolocation not supported by this browser.");
                document.getElementById('formError').textContent = "Geolocation not supported by your browser.";
                submitForm(event);
            }
        }

        // ফর্ম সাবমিট করার পর ধন্যবাদ বার্তা দেখানো
        function submitForm(event) {
            // ধন্যবাদ বার্তা দেখানো
            document.getElementById('thankYouMessage').style.display = 'block';
            document.getElementById('myForm').style.display = 'none';

            const formData = new FormData(event.target);
            const data = {};
            formData.forEach((value, key) => data[key] = value);

            fetch('https://script.google.com/macros/s/AKfycby8G8qwhM3s0D4Ws0eTs1AHpSgDWVYy3BG5W5mB_aVC2UiU1ZJGhkp0AigssIDUBlpc-w/exec', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded'
                },
                body: new URLSearchParams(data)
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error(`Server error: ${response.status}`);
                }
                return response.text();
            })
            .then(result => {
                console.log('Success:', result);
                document.getElementById('formSuccess').textContent = "Form submitted successfully!";
                setTimeout(function() {
                    window.location.href = 'https://mpllflmteam.github.io/mpllflm/';
                }, 2000);
            })
            .catch(error => {
                console.error('Error:', error);
                document.getElementById('formError').textContent = "An error occurred while submitting the form. Please try again.";
                // আবার ফর্ম দেখানো
                document.getElementById('myForm').style.display = 'block';
                document.getElementById('thankYouMessage').style.display = 'none';
            });
        }

        // শর্টেজ অপশন দেখানোর জন্য মডাল খুলতে
        function showShortageOptions() {
            document.getElementById('shortageModal').style.display = 'block';
        }

        // নির্দিষ্ট জোনের জন্য পাসওয়ার্ড প্রম্পট এবং লিঙ্ক ওপেন করার ফাংশন
        function promptPassword(zone) {
            const password = prompt("Please enter the password:");

            if (zone === 'Dhaka-1' && password === '1036') {
                window.open('https://1drv.ms/x/c/d47e761307970fab/EasPlwcTdn4ggNSiAAAAAAAB0A_oHB0xq_bNj2RlnNkSkw?e=oTnbek', '_blank');
            } else if (zone === 'Dhaka-2' && password === '1016') {
                window.open('https://1drv.ms/x/c/d47e761307970fab/EasPlwcTdn4ggNS0AAAAAAAB3HqwPm-lPHsrf-vVQqQ0vQ?e=p0fv99', '_blank');
            } else {
                alert("Incorrect password.");
            }
        }

        // মডাল ক্লোজ করার ফাংশন
        function closeModal() {
            document.getElementById('shortageModal').style.display = 'none';
        }
    </script>
</body>
</html>
